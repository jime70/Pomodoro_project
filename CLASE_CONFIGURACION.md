# üéì Clase Completa: Sistema de Configuraci√≥n del Pomodoro Timer

## üìö √çndice de la Clase

1. [Introducci√≥n: ¬øQu√© Construimos?](#introducci√≥n)
2. [Lecci√≥n 1: El Hook useSettings (El Cerebro)](#lecci√≥n-1)
3. [Lecci√≥n 2: El Componente TimerSettings (La Interfaz)](#lecci√≥n-2)
4. [Lecci√≥n 3: Integraci√≥n con HomePage](#lecci√≥n-3)
5. [Lecci√≥n 4: Conexi√≥n con el Timer](#lecci√≥n-4)
6. [Examen Pr√°ctico: C√≥mo Usar el Sistema](#examen-pr√°ctico)
7. [Conceptos Clave Aprendidos](#conceptos-clave)

---

## üéØ Introducci√≥n: ¬øQu√© Construimos?

Imagina que tienes un **microondas**. El modelo b√°sico tiene solo un bot√≥n: "2 minutos". Siempre cocina por 2 minutos, sin opci√≥n de cambiar.

Ahora imagina un **microondas inteligente**: puedes elegir 2, 3 o 5 minutos. Recuerda tu preferencia. Puedes cambiar el color de la pantalla. Y puedes elegir el sonido de la alarma.

**Eso es exactamente lo que construimos** para tu app de Pomodoro:
- ‚úÖ Elegir duraci√≥n (25, 35 o 45 minutos)
- ‚úÖ Cambiar el fondo (Oto√±o üçÇ o Tormenta ‚õàÔ∏è)
- ‚úÖ Seleccionar sonido de notificaci√≥n
- ‚úÖ **Recordar tus preferencias** para la pr√≥xima vez

---

## üéì Lecci√≥n 1: El Hook useSettings (El Cerebro)

### ¬øQu√© es un Hook Personalizado?

**Analog√≠a:** Es como crear tu propio **control remoto universal**.

Piensa en tu casa: tienes un control remoto para la TV, otro para el aire acondicionado, otro para el ventilador. ¬°Son muchos controles!

Un hook personalizado es como crear **UN SOLO control remoto** que maneje todo. Presionas un bot√≥n y controla lo que necesites.

### ¬øQu√© hace `useSettings`?

```javascript
const useSettings = () => {
  // 1. ESTADO: Guarda las preferencias actuales
  const [sessionDuration, setSessionDuration] = useState(25);
  const [backgroundTheme, setBackgroundTheme] = useState('autumn');
  const [notificationSound, setNotificationSound] = useState('bell');
  
  // 2. CARGAR: Lee las preferencias guardadas (como abrir Netflix y ver tu historial)
  useEffect(() => {
    loadSettings(); // Lee de localStorage
  }, []);
  
  // 3. ACTUALIZAR: Cambia y guarda las preferencias
  const updateSessionDuration = (duration) => {
    setSessionDuration(duration);
    localStorage.setItem('sessionDuration', duration);
  };
  
  // 4. RETORNAR: Da acceso a todo
  return {
    sessionDuration,
    backgroundTheme,
    notificationSound,
    updateSessionDuration,
    updateBackgroundTheme,
    updateNotificationSound
  };
};
```

### Conceptos Importantes:

#### A) **localStorage** - La Memoria de Tu Navegador

**Analog√≠a:** Es como los Post-its en tu nevera.

Cuando apagas tu computadora, el navegador "olvida" muchas cosas. Pero localStorage es como escribir en un Post-it y pegarlo en la nevera: **la pr√≥xima vez que abras la nevera (navegador), el Post-it sigue ah√≠**.

```javascript
// GUARDAR (escribir en el Post-it)
localStorage.setItem('sessionDuration', '45');

// LEER (leer el Post-it)
const duration = localStorage.getItem('sessionDuration'); // "45"

// BORRAR (quitar el Post-it)
localStorage.removeItem('sessionDuration');
```

#### B) **useEffect** - El Guardia Autom√°tico

**Analog√≠a:** Es como un sensor de movimiento que enciende las luces autom√°ticamente.

```javascript
useEffect(() => {
  loadSettings(); // Esto se ejecuta AUTOM√ÅTICAMENTE al cargar el componente
}, []); // Los [] significan: "hazlo solo una vez, al inicio"
```

Es como decir: _"Cuando entres a la casa (componente), enciende las luces (carga settings) autom√°ticamente"._

#### C) **useState** - La Caja de Cambios

**Analog√≠a:** Es como una caja con dos cosas:
1. El contenido actual (la carta adentro)
2. Un m√©todo para cambiar el contenido (abrir la caja y poner otra carta)

```javascript
const [sessionDuration, setSessionDuration] = useState(25);
//     ‚Üë lo que hay ahora    ‚Üë funci√≥n para cambiarlo     ‚Üë valor inicial

// Leer el valor actual
console.log(sessionDuration); // 25

// Cambiar el valor
setSessionDuration(45);
console.log(sessionDuration); // 45 (actualizado)
```

---

## üéì Lecci√≥n 2: El Componente TimerSettings (La Interfaz)

### ¬øQu√© es un Componente con Modal?

**Analog√≠a:** Es como el panel de control de tu aire acondicionado en tu celular.

Imagina una app de control remoto:
- Presionas el bot√≥n ‚öôÔ∏è ‚Üí Se abre una pantalla sobre tu app actual
- Ves las opciones: temperatura, modo, velocidad
- Cambias lo que quieres
- Presionas "Guardar" ‚Üí La pantalla desaparece

**Eso es exactamente un modal:** una ventana que aparece SOBRE tu contenido actual.

### Estructura del Componente

```javascript
const TimerSettings = ({ isOpen, onClose }) => {
  // 1. Obtener configuraci√≥n actual
  const { sessionDuration, backgroundTheme, updateSessionDuration } = useSettings();
  
  // 2. Si no est√° abierto, no mostrar nada
  if (!isOpen) return null;
  
  // 3. Mostrar el modal
  return (
    <div className="overlay">  {/* Fondo oscuro */}
      <div className="panel">   {/* Panel blanco */}
        {/* Secci√≥n 1: Duraci√≥n */}
        {/* Secci√≥n 2: Tema */}
        {/* Secci√≥n 3: Sonido */}
      </div>
    </div>
  );
};
```

### Las 3 Secciones Explicadas

#### **Secci√≥n 1: Duraci√≥n de Sesi√≥n** ‚è±Ô∏è

**Analog√≠a:** Como elegir el tama√±o de tu caf√© en Starbucks.

```
‚òï Corto (25 min)  |  ü•§ Mediano (35 min)  |  üç∫ Grande (45 min)
```

**¬øC√≥mo funciona?**

1. Usuario hace clic en "35 min"
2. Llama a `updateSessionDuration(35)`
3. El hook guarda "35" en localStorage
4. El timer se actualiza autom√°ticamente a 35 minutos

**C√≥digo simplificado:**

```javascript
<button onClick={() => updateSessionDuration(35)}>
  35 minutos
</button>
```

#### **Secci√≥n 2: Tema Visual** üé®

**Analog√≠a:** Como cambiar el fondo de pantalla de tu escritorio.

Tienes dos opciones:
- üçÇ Oto√±o (autumn.gif)
- ‚õàÔ∏è Tormenta (storm.gif)

**¬øC√≥mo funciona?**

1. Usuario hace clic en "Tormenta"
2. Llama a `updateBackgroundTheme('storm')`
3. El hook guarda 'storm' en localStorage
4. HomePage detecta el cambio y actualiza el background

**C√≥digo simplificado:**

```javascript
// Mostrar preview del tema
<div style={{ backgroundImage: `url(${stormGif})` }} />

// Al hacer clic
<button onClick={() => updateBackgroundTheme('storm')}>
  Seleccionar
</button>
```

#### **Secci√≥n 3: Sonido de Notificaci√≥n** üîä

**Analog√≠a:** Como elegir el ringtone de tu celular.

**¬øC√≥mo funciona?**

1. Usuario hace clic en "‚ñ∂Ô∏è Probar" ‚Üí Reproduce el sonido
2. Usuario hace clic en la opci√≥n ‚Üí Selecciona ese sonido
3. Se guarda en localStorage

**C√≥digo simplificado:**

```javascript
const handlePreviewSound = (soundId) => {
  console.log('Reproduciendo:', soundId);
  // TODO: Reproducir audio real
  // const audio = new Audio(`/sounds/${soundId}.mp3`);
  // audio.play();
};

<button onClick={() => handlePreviewSound('bell')}>
  ‚ñ∂Ô∏è Probar
</button>
```

---

## üéì Lecci√≥n 3: Integraci√≥n con HomePage

### El Bot√≥n Flotante ‚öôÔ∏è

**Analog√≠a:** Como el bot√≥n de "Configuraci√≥n" en WhatsApp (abajo a la derecha).

```javascript
<button
  onClick={() => setShowSettings(true)}
  style={{
    position: 'fixed',
    bottom: '32px',
    right: '32px',
    // ... estilos de bot√≥n flotante
  }}
>
  ‚öôÔ∏è
</button>
```

**¬øQu√© hace?**
- Cambia `showSettings` de `false` a `true`
- Esto causa que `<TimerSettings isOpen={showSettings} />` se muestre

### Cambio Din√°mico del Background

**Analog√≠a:** Como cuando cambias el modo d√≠a/noche en tu tel√©fono.

```javascript
const { backgroundTheme } = useSettings(); // Lee la preferencia

// Elegir imagen seg√∫n configuraci√≥n
const backgroundImage = backgroundTheme === 'storm' ? stormGif : autumnGif;

// Aplicar al div
<div style={{ backgroundImage: `url(${backgroundImage})` }}>
```

**Flujo completo:**

1. HomePage lee `backgroundTheme` ‚Üí "autumn"
2. Asigna `backgroundImage = autumnGif`
3. Renderiza con fondo de oto√±o üçÇ
4. Usuario abre settings y cambia a "storm" ‚õàÔ∏è
5. `useSettings` detecta el cambio
6. HomePage se re-renderiza autom√°ticamente
7. Ahora `backgroundImage = stormGif`
8. ¬°El fondo cambi√≥ con transici√≥n suave!

---

## üéì Lecci√≥n 4: Conexi√≥n con el Timer

### El Problema que Resolvimos

**Antes:** El timer siempre usaba 25 minutos (hardcoded)

```javascript
const STUDY_TIME = 25 * 60; // ‚ùå Siempre 25 minutos, no se puede cambiar
```

**Despu√©s:** El timer lee la configuraci√≥n del usuario

```javascript
const { sessionDuration } = useSettings(); // Lee: 25, 35 o 45
const STUDY_TIME = sessionDuration * 60;   // ‚úÖ Usa lo que el usuario eligi√≥
```

### Sincronizaci√≥n Autom√°tica

**Analog√≠a:** Como cuando ajustas la temperatura del aire y el aparato cambia autom√°ticamente.

```javascript
useEffect(() => {
  if (!isRunning) {
    setTimeLeft(STUDY_TIME); // Actualiza el tiempo cuando cambia la config
  }
}, [sessionDuration, STUDY_TIME, isRunning]);
```

**Flujo:**

1. Timer muestra 25:00 (config por defecto)
2. Usuario abre settings y elige "45 min"
3. useSettings actualiza `sessionDuration = 45`
4. Timer detecta el cambio (gracias a useEffect)
5. Timer actualiza `STUDY_TIME = 45 * 60 = 2700 segundos`
6. Timer actualiza `timeLeft = 2700`
7. ¬°Ahora muestra 45:00!

---

## üìù Examen Pr√°ctico: C√≥mo Usar el Sistema

### Paso 1: Iniciar Servidores

```bash
# Terminal 1 - Backend
cd d:\pomodoro-project\pomodoro-backend
npm run server

# Terminal 2 - Frontend
cd c:\Users\Hp\Downloads\pomodoro-timer-main\pomodoro-frontend
npm run dev
```

### Paso 2: Abrir la App

```
http://localhost:5173/
```

### Paso 3: Hacer Login

1. Clic en "Registrarse" o "Login"
2. Ingresar credenciales
3. Ver√°s tu nombre arriba a la derecha

### Paso 4: Probar la Configuraci√≥n

#### A) Cambiar Duraci√≥n:

1. Clic en el bot√≥n flotante ‚öôÔ∏è (abajo derecha)
2. En "‚è±Ô∏è Duraci√≥n de Sesi√≥n", clic en "45 min"
3. Clic en "‚úì Guardar Cambios"
4. **Observa:** El timer ahora muestra "45 minutos"
5. Si recargas la p√°gina (F5), sigue en 45 minutos (¬°se guard√≥!)

#### B) Cambiar Tema:

1. Abrir configuraci√≥n ‚öôÔ∏è
2. En "üé® Tema Visual", clic en "Tormenta ‚õàÔ∏è"
3. Guardar
4. **Observa:** El fondo cambi√≥ a la animaci√≥n de tormenta
5. Si recargas, sigue con tormenta (¬°se guard√≥!)

#### C) Cambiar Sonido:

1. Abrir configuraci√≥n ‚öôÔ∏è
2. En "üîä Sonido de Notificaci√≥n", clic en "‚ñ∂Ô∏è Probar" en cada opci√≥n
3. Seleccionar tu favorito
4. Guardar
5. (Por ahora solo se guarda, el audio real est√° pendiente de implementar)

### Paso 5: Usar el Timer

1. Con la duraci√≥n configurada (ej: 45 min)
2. Clic en "Iniciar"
3. El timer empieza desde 45:00
4. ¬°Funciona con tu configuraci√≥n!

---

## üí° Conceptos Clave Aprendidos

### 1. **Custom Hooks** (Hooks Personalizados)

```javascript
const useSettings = () => {
  // L√≥gica reutilizable
  return { valores, funciones };
};
```

**Beneficio:** Separar la l√≥gica de la UI. Como tener el motor (l√≥gica) separado del tablero (UI).

### 2. **localStorage** (Persistencia de Datos)

```javascript
localStorage.setItem('key', 'value');  // Guardar
const value = localStorage.getItem('key'); // Leer
```

**Beneficio:** Los datos sobreviven al cerrar el navegador.

### 3. **Props y Estado**

```javascript
// HomePage pasa props a TimerSettings
<TimerSettings isOpen={showSettings} onClose={() => setShowSettings(false)} />

// TimerSettings recibe y usa los props
const TimerSettings = ({ isOpen, onClose }) => {
  if (!isOpen) return null;
  // ...
};
```

**Beneficio:** Comunicaci√≥n entre componentes padre-hijo.

### 4. **Modales** (Ventanas Emergentes)

Estructura t√≠pica:

```javascript
{isOpen && (
  <div className="overlay" onClick={onClose}>
    <div className="modal" onClick={(e) => e.stopPropagation()}>
      {/* Contenido */}
    </div>
  </div>
)}
```

**Truco:** `stopPropagation()` evita que al hacer clic dentro del modal, se cierre.

### 5. **Sincronizaci√≥n Reactiva**

```javascript
useEffect(() => {
  // Se ejecuta cuando 'sessionDuration' cambia
  setTimeLeft(STUDY_TIME);
}, [sessionDuration]);
```

**Beneficio:** Los componentes se actualizan autom√°ticamente cuando cambian los datos.

---

## üéØ Diagrama de Flujo Completo

```
USUARIO
  ‚îÇ
  ‚îú‚îÄ> Abre Configuraci√≥n (clic en ‚öôÔ∏è)
  ‚îÇ     ‚îÇ
  ‚îÇ     ‚îî‚îÄ> HomePage cambia showSettings = true
  ‚îÇ           ‚îÇ
  ‚îÇ           ‚îî‚îÄ> TimerSettings se renderiza
  ‚îÇ                 ‚îÇ
  ‚îÇ                 ‚îú‚îÄ> useSettings lee preferencias actuales
  ‚îÇ                 ‚îÇ     (desde localStorage)
  ‚îÇ                 ‚îÇ
  ‚îÇ                 ‚îî‚îÄ> Usuario selecciona "45 min"
  ‚îÇ                       ‚îÇ
  ‚îÇ                       ‚îî‚îÄ> updateSessionDuration(45)
  ‚îÇ                             ‚îÇ
  ‚îÇ                             ‚îú‚îÄ> Actualiza estado local
  ‚îÇ                             ‚îî‚îÄ> Guarda en localStorage
  ‚îÇ
  ‚îú‚îÄ> Cierra Configuraci√≥n
  ‚îÇ     ‚îÇ
  ‚îÇ     ‚îî‚îÄ> HomePage detecta cambio en sessionDuration
  ‚îÇ           ‚îÇ
  ‚îÇ           ‚îî‚îÄ> PomodoroTimer se re-renderiza
  ‚îÇ                 ‚îÇ
  ‚îÇ                 ‚îî‚îÄ> STUDY_TIME = 45 * 60
  ‚îÇ                       ‚îÇ
  ‚îÇ                       ‚îî‚îÄ> Timer muestra 45:00
  ‚îÇ
  ‚îî‚îÄ> Inicia Timer
        ‚îÇ
        ‚îî‚îÄ> Corre con 45 minutos configurados
```

---

## üèÜ Resumen: ¬øQu√© Logramos?

‚úÖ **Sistema de configuraci√≥n completo** con 3 opciones  
‚úÖ **Persistencia de preferencias** en localStorage  
‚úÖ **UI intuitiva** con previews visuales  
‚úÖ **Sincronizaci√≥n autom√°tica** entre componentes  
‚úÖ **C√≥digo organizado** con hooks personalizados  
‚úÖ **Experiencia de usuario** mejorada (como apps profesionales)  

---

## üìö Tarea para el Alumno

Para profundizar tu aprendizaje, intenta:

1. **Agregar m√°s duraciones:** 10 min, 60 min
2. **Agregar m√°s temas:** Playa, Monta√±a, Ciudad
3. **Implementar audio real:** Agregar archivos .mp3 y reproducirlos
4. **Agregar modo oscuro:** Tema claro/oscuro para la UI
5. **Guardar en backend:** En vez de localStorage, guardar preferencias en la base de datos

---

## üéì Fin de la Clase

**¬°Felicidades!** üéâ Has completado el sistema de configuraci√≥n.

**Aprendiste:**
- Crear hooks personalizados
- Usar localStorage
- Crear modales
- Sincronizar componentes
- Mejorar UX

**Pr√≥xima clase:** Integraci√≥n con el backend para guardar sesiones completadas y crear estad√≠sticas.

---

**Profesor:** Tu Asistente AI  
**Curso:** Desarrollo Full-Stack con React y Node.js  
**Proyecto:** Pomodoro Timer App  
**Fase:** 4 de 6 ‚úÖ

